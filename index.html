<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>FUEL ‚Äî Calorie & Macro Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0c0e14;
  --bg2: #111320;
  --card: #161923;
  --card-hover: #1c2030;
  --border: #252838;
  --accent: #e8a948;
  --accent-dim: rgba(232,169,72,0.12);
  --accent-glow: rgba(232,169,72,0.3);
  --text: #eee9df;
  --text2: #7d8094;
  --danger: #e05858;
  --success: #50c878;
  --protein: #f0a050;
  --carbs: #5eb8d8;
  --fat: #e06080;
  --radius: 14px;
  --font: 'DM Sans', system-ui, sans-serif;
  --font-display: 'Playfair Display', Georgia, serif;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; overflow: hidden; }
body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  -webkit-font-smoothing: antialiased;
}
::selection { background: var(--accent-dim); }
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; }
input[type=number] { -moz-appearance: textfield; }
::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

#app {
  max-width: 480px;
  margin: 0 auto;
  height: 100vh;
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
}

/* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
.header {
  padding: 14px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid rgba(37,40,56,0.5);
  flex-shrink: 0;
  z-index: 10;
  background: var(--bg);
}
.header-brand {
  display: flex;
  align-items: center;
  gap: 8px;
}
.header-brand .icon { font-size: 18px; }
.header-brand .name {
  font-family: var(--font-display);
  font-size: 20px;
  font-weight: 900;
  letter-spacing: 3px;
  color: var(--accent);
}
.header-cal { font-size: 12px; font-weight: 700; color: var(--accent); }

/* ‚îÄ‚îÄ Content ‚îÄ‚îÄ */
.content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 16px 16px 24px;
  scroll-behavior: smooth;
}

/* ‚îÄ‚îÄ Bottom Nav ‚îÄ‚îÄ */
.bottom-nav {
  display: flex;
  justify-content: space-around;
  background: var(--card);
  border-top: 1px solid var(--border);
  padding: 6px 0 max(10px, env(safe-area-inset-bottom));
  flex-shrink: 0;
  z-index: 100;
}
.nav-btn {
  background: none;
  border: none;
  cursor: pointer;
  padding: 6px 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  color: var(--text2);
  transition: color 0.2s;
}
.nav-btn.active { color: var(--accent); }
.nav-btn .nav-icon { font-size: 18px; }
.nav-btn .nav-label { font-size: 10px; font-weight: 700; letter-spacing: 0.5px; }

/* ‚îÄ‚îÄ FAB ‚îÄ‚îÄ */
.fab {
  position: absolute;
  bottom: 72px;
  right: 20px;
  width: 56px;
  height: 56px;
  border-radius: 16px;
  border: none;
  background: var(--accent);
  color: var(--bg);
  font-size: 30px;
  font-weight: 300;
  cursor: pointer;
  box-shadow: 0 4px 24px var(--accent-glow);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.15s, box-shadow 0.15s;
  z-index: 50;
  line-height: 1;
}
.fab:hover { transform: scale(1.06); }
.fab:active { transform: scale(0.96); }

/* ‚îÄ‚îÄ Date Nav ‚îÄ‚îÄ */
.date-nav {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
  margin-bottom: 20px;
}
.date-nav button {
  background: none;
  border: none;
  color: var(--text);
  font-size: 22px;
  cursor: pointer;
  padding: 4px 10px;
  border-radius: 8px;
  transition: background 0.15s;
}
.date-nav button:hover { background: var(--card); }
.date-nav .date-text { text-align: center; }
.date-nav .date-main { font-size: 16px; font-weight: 700; }
.date-nav .date-today { font-size: 10px; color: var(--accent); font-weight: 700; letter-spacing: 1.5px; margin-top: 2px; }

/* ‚îÄ‚îÄ Summary Grid ‚îÄ‚îÄ */
.summary-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-bottom: 18px;
}
.card {
  background: var(--card);
  border-radius: var(--radius);
  padding: 18px;
}
.ring-card { display: flex; flex-direction: column; align-items: center; }
.ring-wrap { position: relative; width: 120px; height: 120px; }
.ring-wrap svg { transform: rotate(-90deg); }
.ring-center {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.ring-val { font-size: 26px; font-weight: 800; font-family: var(--font-display); }
.ring-sub { font-size: 10px; color: var(--text2); }
.ring-remaining { font-size: 11px; color: var(--text2); margin-top: 8px; font-weight: 600; }

/* ‚îÄ‚îÄ Macro bars ‚îÄ‚îÄ */
.macro-card { display: flex; flex-direction: column; gap: 14px; justify-content: center; }
.macro-row label {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  margin-bottom: 5px;
}
.macro-row .macro-name { font-weight: 700; }
.macro-row .macro-val { font-weight: 800; color: var(--text); }
.macro-bar {
  height: 6px;
  background: var(--border);
  border-radius: 3px;
  overflow: hidden;
}
.macro-bar-fill {
  height: 100%;
  border-radius: 3px;
  transition: width 0.5s ease;
}
.total-grams { font-size: 11px; color: var(--text2); text-align: center; margin-top: 4px; }

/* ‚îÄ‚îÄ Drinks ‚îÄ‚îÄ */
.drinks-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin-bottom: 18px;
}
.drink-card {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  background: var(--card);
  border-radius: 12px;
}
.drink-card .drink-icon { font-size: 20px; }
.drink-card .drink-info { flex: 1; }
.drink-card .drink-label { font-size: 13px; font-weight: 700; }
.drink-card .drink-count { font-size: 11px; color: var(--text2); }
.drink-btn {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-size: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.1s;
}
.drink-btn:active { transform: scale(0.9); }
.drink-btn.minus { background: none; border: 1px solid var(--border); color: var(--text); }
.drink-btn.plus { background: var(--accent); color: var(--bg); font-weight: 700; }

/* ‚îÄ‚îÄ Meal Group ‚îÄ‚îÄ */
.meal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 4px;
  margin-bottom: 8px;
}
.meal-header .meal-name {
  font-size: 12px;
  font-weight: 800;
  color: var(--text2);
  letter-spacing: 1.2px;
  text-transform: uppercase;
}
.meal-header .meal-cal { font-size: 13px; font-weight: 800; color: var(--accent); }
.meal-group { margin-bottom: 18px; }

/* ‚îÄ‚îÄ Entry Row ‚îÄ‚îÄ */
.entry-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  background: var(--card);
  border-radius: 12px;
  margin-bottom: 5px;
  border-left: 3px solid rgba(232,169,72,0.25);
  transition: background 0.15s;
  cursor: default;
}
.entry-row:hover { background: var(--card-hover); }
.entry-icon { font-size: 20px; flex-shrink: 0; }
.entry-info { flex: 1; min-width: 0; }
.entry-name { font-size: 14px; font-weight: 700; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.entry-meta { font-size: 11px; color: var(--text2); margin-top: 2px; }
.entry-cals { text-align: right; flex-shrink: 0; }
.entry-cal-val { font-size: 17px; font-weight: 800; color: var(--accent); font-family: var(--font-display); }
.entry-macros { font-size: 10px; color: var(--text2); margin-top: 2px; }
.entry-macros .mp { color: var(--protein); }
.entry-macros .mc { color: var(--carbs); }
.entry-macros .mf { color: var(--fat); }
.entry-del {
  background: none;
  border: none;
  color: var(--text2);
  cursor: pointer;
  font-size: 14px;
  padding: 6px;
  border-radius: 6px;
  transition: color 0.15s;
  flex-shrink: 0;
}
.entry-del:hover { color: var(--danger); }

/* ‚îÄ‚îÄ Empty State ‚îÄ‚îÄ */
.empty-state {
  text-align: center;
  padding: 48px 20px;
  color: var(--text2);
}
.empty-state .empty-icon { font-size: 40px; margin-bottom: 10px; }
.empty-state .empty-title { font-size: 15px; font-weight: 600; }
.empty-state .empty-sub { font-size: 12px; margin-top: 4px; }

/* ‚îÄ‚îÄ Modal Overlay ‚îÄ‚îÄ */
.modal-overlay {
  position: fixed;
  inset: 0;
  z-index: 1000;
  background: rgba(0,0,0,0.65);
  display: flex;
  align-items: flex-end;
  justify-content: center;
  animation: fadeIn 0.15s ease;
}
@keyframes fadeIn { from { opacity: 0 } to { opacity: 1 } }
.modal-sheet {
  width: 100%;
  max-width: 480px;
  max-height: 88vh;
  overflow-y: auto;
  background: var(--bg2);
  border-radius: 20px 20px 0 0;
  padding: 20px 20px 32px;
  animation: slideUp 0.25s ease;
}
.modal-center {
  align-items: center;
}
.modal-box {
  width: 100%;
  max-width: 420px;
  background: var(--bg2);
  border-radius: 20px;
  padding: 24px;
  animation: popIn 0.2s ease;
}
@keyframes slideUp { from { transform: translateY(100%) } to { transform: translateY(0) } }
@keyframes popIn { from { transform: scale(0.95); opacity: 0 } to { transform: scale(1); opacity: 1 } }

.modal-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}
.modal-title { font-size: 17px; font-weight: 800; }
.modal-close {
  background: none;
  border: none;
  color: var(--text2);
  font-size: 20px;
  cursor: pointer;
  padding: 4px;
}

/* ‚îÄ‚îÄ Meal Tabs ‚îÄ‚îÄ */
.meal-tabs {
  display: flex;
  gap: 6px;
  margin-bottom: 14px;
}
.meal-tab {
  flex: 1;
  padding: 9px 4px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--text2);
  font-size: 12px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.15s;
}
.meal-tab.active {
  border-color: var(--accent);
  background: var(--accent-dim);
  color: var(--accent);
}

/* ‚îÄ‚îÄ Search Input ‚îÄ‚îÄ */
.search-input {
  width: 100%;
  padding: 14px 16px;
  border-radius: 12px;
  border: 1.5px solid rgba(232,169,72,0.4);
  background: var(--bg);
  color: var(--text);
  font-size: 15px;
  font-family: var(--font);
  outline: none;
  margin-bottom: 10px;
  transition: border-color 0.15s;
}
.search-input:focus { border-color: var(--accent); }
.search-input::placeholder { color: var(--text2); }

/* ‚îÄ‚îÄ Category Pills ‚îÄ‚îÄ */
.cat-pills {
  display: flex;
  gap: 5px;
  flex-wrap: wrap;
  margin-bottom: 10px;
}
.cat-pill {
  padding: 5px 10px;
  border-radius: 16px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--text2);
  font-size: 12px;
  cursor: pointer;
  transition: all 0.15s;
}
.cat-pill.active {
  border-color: var(--accent);
  background: var(--accent-dim);
  color: var(--accent);
}

/* ‚îÄ‚îÄ Recent Chips ‚îÄ‚îÄ */
.recent-section { margin-bottom: 10px; }
.recent-label { font-size: 10px; font-weight: 800; color: var(--text2); letter-spacing: 0.8px; margin-bottom: 6px; }
.recent-chips { display: flex; gap: 6px; flex-wrap: wrap; }
.recent-chip {
  padding: 6px 12px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--card-hover);
  color: var(--text);
  font-size: 12px;
  cursor: pointer;
  transition: background 0.15s;
}
.recent-chip:hover { background: var(--border); }

/* ‚îÄ‚îÄ Food Result List ‚îÄ‚îÄ */
.food-results { max-height: 300px; overflow-y: auto; }
.food-result {
  width: 100%;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 11px 12px;
  background: transparent;
  border: none;
  border-bottom: 1px solid rgba(37,40,56,0.3);
  cursor: pointer;
  text-align: left;
  color: var(--text);
  font-family: var(--font);
  border-radius: 8px;
  transition: background 0.1s;
}
.food-result:hover { background: var(--card-hover); }
.food-result .fr-icon { font-size: 18px; }
.food-result .fr-info { flex: 1; }
.food-result .fr-name { font-size: 13px; font-weight: 700; }
.food-result .fr-macros { font-size: 11px; color: var(--text2); margin-top: 1px; }
.food-result .fr-cal { font-size: 14px; font-weight: 800; color: var(--accent); }
.food-result .fr-unit { font-size: 10px; color: var(--text2); }

/* ‚îÄ‚îÄ Gram Input Section ‚îÄ‚îÄ */
.gram-header { text-align: center; padding: 10px 0 16px; }
.gram-header .gh-icon { font-size: 32px; margin-bottom: 4px; }
.gram-header .gh-cal { font-size: 12px; color: var(--text2); }
.gram-header .gh-macros { font-size: 10px; color: var(--text2); margin-top: 2px; }
.gram-input-wrap { position: relative; margin-bottom: 14px; }
.gram-input {
  width: 100%;
  padding: 22px 70px 22px 16px;
  border-radius: 14px;
  border: 2px solid var(--accent);
  background: var(--bg);
  color: var(--text);
  font-size: 34px;
  font-weight: 800;
  font-family: var(--font-display);
  text-align: center;
  outline: none;
}
.gram-unit {
  position: absolute;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 16px;
  color: var(--text2);
  font-weight: 600;
}
.quick-weights {
  display: flex;
  gap: 5px;
  justify-content: center;
  flex-wrap: wrap;
  margin-bottom: 18px;
}
.qw-btn {
  padding: 6px 11px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--text2);
  font-size: 12px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.15s;
}
.qw-btn.active { border-color: var(--accent); background: var(--accent-dim); color: var(--accent); }

/* ‚îÄ‚îÄ Live Preview ‚îÄ‚îÄ */
.live-preview {
  background: var(--bg);
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 18px;
}
.lp-top {
  display: flex;
  justify-content: space-between;
  margin-bottom: 10px;
}
.lp-label { font-size: 13px; color: var(--text2); }
.lp-cal { font-size: 20px; font-weight: 800; color: var(--accent); font-family: var(--font-display); }
.lp-macros { display: flex; gap: 24px; justify-content: center; }
.lp-macro { text-align: center; }
.lp-macro-val { font-size: 16px; font-weight: 800; }
.lp-macro-label { font-size: 10px; color: var(--text2); }

/* ‚îÄ‚îÄ Action Buttons ‚îÄ‚îÄ */
.action-row { display: flex; gap: 10px; }
.btn-secondary {
  flex: 1;
  padding: 14px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--text2);
  font-size: 14px;
  font-weight: 700;
  cursor: pointer;
  font-family: var(--font);
}
.btn-primary {
  flex: 2;
  padding: 14px;
  border-radius: 12px;
  border: none;
  background: var(--accent);
  color: var(--bg);
  font-size: 14px;
  font-weight: 800;
  cursor: pointer;
  font-family: var(--font);
  transition: opacity 0.15s;
}
.btn-primary:disabled { opacity: 0.4; cursor: default; }

/* ‚îÄ‚îÄ Dashboard ‚îÄ‚îÄ */
.dash-title { font-size: 20px; font-weight: 900; font-family: var(--font-display); margin-bottom: 2px; }
.dash-sub { font-size: 12px; color: var(--text2); margin-bottom: 20px; }
.chart-card { margin-bottom: 14px; }
.chart-label { font-size: 12px; font-weight: 800; color: var(--text2); letter-spacing: 0.8px; margin-bottom: 4px; }
.chart-value { font-size: 22px; font-weight: 800; font-family: var(--font-display); margin-bottom: 14px; }
.bar-chart { display: flex; align-items: flex-end; gap: 8px; height: 130px; padding-top: 8px; }
.bar-col { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 6px; height: 100%; justify-content: flex-end; }
.bar-val { font-size: 9px; color: var(--text2); font-weight: 700; }
.bar-fill { width: 100%; border-radius: 6px 6px 2px 2px; transition: height 0.5s ease; min-height: 2px; }
.bar-label { font-size: 10px; color: var(--text2); font-weight: 600; }
.bar-col.today .bar-fill { background: var(--accent); }
.bar-col:not(.today) .bar-fill { background: rgba(232,169,72,0.3); }

/* ‚îÄ‚îÄ Stat Grid ‚îÄ‚îÄ */
.stat-grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 12px;
  margin-top: 12px;
}
.stat-item { text-align: center; }
.stat-val { font-size: 18px; font-weight: 800; font-family: var(--font-display); }
.stat-label { font-size: 10px; color: var(--text2); margin-top: 2px; }

/* ‚îÄ‚îÄ Macro Pie (CSS) ‚îÄ‚îÄ */
.pie-card { display: flex; flex-direction: column; align-items: center; }
.pie-wrap { width: 110px; height: 110px; border-radius: 50%; position: relative; margin-bottom: 10px; }
.pie-center {
  position: absolute;
  inset: 16px;
  border-radius: 50%;
  background: var(--card);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
}
.pie-center-val { font-size: 14px; font-weight: 800; font-family: var(--font-display); }
.pie-center-label { font-size: 8px; color: var(--text2); }
.pie-legend { display: flex; gap: 12px; }
.pie-leg-item { text-align: center; }
.pie-leg-name { font-size: 10px; font-weight: 700; }
.pie-leg-pct { font-size: 12px; font-weight: 800; }

/* ‚îÄ‚îÄ Category Breakdown ‚îÄ‚îÄ */
.cat-break { margin-bottom: 10px; }
.cat-break-row { margin-bottom: 8px; }
.cat-break-head { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 3px; }
.cat-break-name { color: var(--text); }
.cat-break-val { color: var(--accent); font-weight: 800; }
.cat-break-bar { height: 4px; background: var(--border); border-radius: 2px; overflow: hidden; }
.cat-break-fill { height: 100%; background: var(--accent); border-radius: 2px; transition: width 0.4s ease; }

/* ‚îÄ‚îÄ Food DB page ‚îÄ‚îÄ */
.foods-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
.foods-title { font-size: 20px; font-weight: 900; font-family: var(--font-display); }
.foods-count { font-size: 12px; color: var(--text2); }
.add-food-btn {
  background: var(--accent);
  color: var(--bg);
  border: none;
  border-radius: 10px;
  padding: 8px 16px;
  font-size: 13px;
  font-weight: 800;
  cursor: pointer;
  font-family: var(--font);
}
.food-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  background: var(--card);
  border-radius: 10px;
  margin-bottom: 4px;
}
.food-item .fi-icon { font-size: 17px; }
.food-item .fi-info { flex: 1; }
.food-item .fi-name { font-size: 13px; font-weight: 700; }
.food-item .fi-cat { font-size: 11px; color: var(--text2); }
.food-item .fi-cal-col { text-align: right; }
.food-item .fi-cal { font-size: 14px; font-weight: 800; color: var(--accent); }
.food-item .fi-calunit { font-size: 10px; color: var(--text2); }
.food-item .fi-macros { font-size: 10px; color: var(--text2); text-align: right; min-width: 80px; }

/* ‚îÄ‚îÄ Settings ‚îÄ‚îÄ */
.settings-title { font-size: 20px; font-weight: 900; font-family: var(--font-display); margin-bottom: 20px; }
.settings-section { margin-bottom: 16px; }
.settings-label { font-size: 12px; font-weight: 800; color: var(--text2); letter-spacing: 0.8px; margin-bottom: 14px; }
.settings-field { margin-bottom: 14px; }
.settings-field label { font-size: 13px; font-weight: 700; display: block; margin-bottom: 6px; }
.settings-input {
  width: 100%;
  padding: 11px 14px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--bg);
  color: var(--text);
  font-size: 16px;
  font-weight: 700;
  font-family: var(--font);
  outline: none;
}
.settings-input:focus { border-color: var(--accent); }
.btn-danger {
  width: 100%;
  padding: 13px;
  border-radius: 10px;
  border: 1px solid rgba(224,88,88,0.3);
  background: rgba(224,88,88,0.08);
  color: var(--danger);
  font-size: 13px;
  font-weight: 800;
  cursor: pointer;
  font-family: var(--font);
}
.about-text { font-size: 13px; line-height: 1.7; }
.about-text strong { color: var(--accent); }

/* ‚îÄ‚îÄ Custom Food Form ‚îÄ‚îÄ */
.custom-field { margin-bottom: 12px; }
.custom-field label { font-size: 12px; color: var(--text2); display: block; margin-bottom: 4px; }
.custom-field input, .custom-field select {
  width: 100%;
  padding: 10px 14px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--bg);
  color: var(--text);
  font-size: 14px;
  font-family: var(--font);
  outline: none;
}
.custom-field input:focus, .custom-field select:focus { border-color: var(--accent); }
.custom-sub { font-size: 12px; color: var(--text2); margin-bottom: 16px; }

/* ‚îÄ‚îÄ Protein Area Chart (CSS based) ‚îÄ‚îÄ */
.area-chart { position: relative; height: 100px; display: flex; align-items: flex-end; gap: 4px; }
.area-chart .ac-col { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: flex-end; height: 100%; }
.area-chart .ac-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--protein); flex-shrink: 0; z-index: 2; }
.area-chart .ac-bar { width: 100%; border-radius: 4px 4px 0 0; background: rgba(240,160,80,0.15); transition: height 0.5s ease; }
.area-chart .ac-label { font-size: 10px; color: var(--text2); margin-top: 4px; }

.two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 14px; }
</style>
</head>
<body>

<div id="app">
  <div class="header">
    <div class="header-brand">
      <span class="icon">‚ö°</span>
      <span class="name">FUEL</span>
    </div>
    <div class="header-cal" id="headerCal"></div>
  </div>
  <div class="content" id="content"></div>
  <button class="fab" id="fab" onclick="openAddModal()">+</button>
  <nav class="bottom-nav" id="bottomNav"></nav>
</div>

<div class="modal-overlay" id="modalOverlay" style="display:none" onclick="if(event.target===this)closeModal()">
  <div class="modal-sheet" id="modalSheet"></div>
</div>
<div class="modal-overlay modal-center" id="customOverlay" style="display:none" onclick="if(event.target===this)closeCustom()">
  <div class="modal-box" id="customBox"></div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const FOOD_DB=[
  {id:"p01",name:"Cheese Feta",cat:"Proteins",cal:257,p:14.2,c:4.1,f:21.3},
  {id:"p02",name:"Cheese Goat",cat:"Proteins",cal:318,p:21.6,c:0.1,f:25.6},
  {id:"p03",name:"Cheese Gouda",cat:"Proteins",cal:394,p:26.5,c:1.6,f:31.0},
  {id:"p04",name:"Cheese Haloumi",cat:"Proteins",cal:359,p:25.0,c:1.7,f:28.6},
  {id:"p05",name:"Chicken Breast Boiled",cat:"Proteins",cal:110,p:23.1,c:0,f:1.2},
  {id:"p06",name:"Chicken Breast Roasted",cat:"Proteins",cal:197,p:30.0,c:0,f:7.8},
  {id:"p07",name:"Chicken Thigh Roasted",cat:"Proteins",cal:179,p:22.6,c:0,f:9.5},
  {id:"p08",name:"Eggs Hard Boiled",cat:"Proteins",cal:155,p:12.6,c:1.1,f:10.6},
  {id:"p09",name:"Milk",cat:"Proteins",cal:62,p:3.2,c:4.8,f:3.3},
  {id:"p10",name:"Pulled Pork",cat:"Proteins",cal:168,p:22.0,c:4.0,f:7.0},
  {id:"p11",name:"Salmon",cat:"Proteins",cal:200,p:20.4,c:0,f:12.4},
  {id:"p12",name:"Tuna",cat:"Proteins",cal:109,p:24.4,c:0,f:0.5},
  {id:"p13",name:"Yogurt",cat:"Proteins",cal:77,p:3.5,c:7.0,f:3.3},
  {id:"d01",name:"Raisins",cat:"Dried Fruits",cal:299,p:3.1,c:79.2,f:0.5},
  {id:"d02",name:"Dates",cat:"Dried Fruits",cal:282,p:2.5,c:75.0,f:0.4},
  {id:"b01",name:"Wholemeal Bread",cat:"Bread",cal:218,p:8.5,c:41.3,f:3.4},
  {id:"b02",name:"Koulouraki",cat:"Bread",cal:450,p:7.0,c:58.0,f:20.0},
  {id:"f01",name:"Apples",cat:"Fruits",cal:52,p:0.3,c:13.8,f:0.2},
  {id:"f02",name:"Apricots",cat:"Fruits",cal:48,p:1.4,c:11.1,f:0.4},
  {id:"f03",name:"Bananas",cat:"Fruits",cal:89,p:1.1,c:22.8,f:0.3},
  {id:"f04",name:"Cherries",cat:"Fruits",cal:50,p:1.0,c:12.2,f:0.3},
  {id:"f05",name:"Figs",cat:"Fruits",cal:107,p:1.3,c:27.6,f:0.3},
  {id:"f06",name:"Grapes",cat:"Fruits",cal:69,p:0.7,c:18.1,f:0.2},
  {id:"f07",name:"Kiwi",cat:"Fruits",cal:61,p:1.1,c:14.7,f:0.5},
  {id:"f08",name:"Mandarin",cat:"Fruits",cal:53,p:0.8,c:13.3,f:0.3},
  {id:"f09",name:"Mangos",cat:"Fruits",cal:60,p:0.8,c:15.0,f:0.4},
  {id:"f10",name:"Nectarines",cat:"Fruits",cal:44,p:1.1,c:10.6,f:0.3},
  {id:"f11",name:"Oranges",cat:"Fruits",cal:47,p:0.9,c:11.7,f:0.1},
  {id:"f12",name:"Peaches",cat:"Fruits",cal:39,p:0.9,c:9.5,f:0.3},
  {id:"f13",name:"Pears",cat:"Fruits",cal:57,p:0.4,c:15.2,f:0.1},
  {id:"f14",name:"Plums",cat:"Fruits",cal:46,p:0.7,c:11.4,f:0.3},
  {id:"f15",name:"Prickly Pears",cat:"Fruits",cal:41,p:0.7,c:9.6,f:0.5},
  {id:"f16",name:"Pomegranate",cat:"Fruits",cal:83,p:1.7,c:18.7,f:1.2},
  {id:"f17",name:"Pomelo",cat:"Fruits",cal:38,p:0.8,c:9.6,f:0},
  {id:"f18",name:"Quince",cat:"Fruits",cal:57,p:0.4,c:15.3,f:0.1},
  {id:"f19",name:"Watermelon",cat:"Fruits",cal:30,p:0.6,c:7.6,f:0.2},
  {id:"f20",name:"Melon",cat:"Fruits",cal:36,p:0.8,c:8.2,f:0.2},
  {id:"n01",name:"Almonds",cat:"Nuts",cal:576,p:21.2,c:21.7,f:49.4},
  {id:"n02",name:"Hazelnuts",cat:"Nuts",cal:628,p:15.0,c:16.7,f:60.8},
  {id:"n03",name:"Pecans",cat:"Nuts",cal:700,p:9.2,c:13.9,f:72.0},
  {id:"n04",name:"Roasted Salted Peanuts",cat:"Nuts",cal:585,p:23.7,c:21.5,f:49.2},
  {id:"n05",name:"Sunflower Seeds",cat:"Nuts",cal:584,p:20.8,c:20.0,f:51.5},
  {id:"n06",name:"Walnuts",cat:"Nuts",cal:654,p:15.2,c:13.7,f:65.2},
  {id:"o01",name:"Butter",cat:"Oils",cal:747,p:0.9,c:0.1,f:83.0},
  {id:"o02",name:"Dressing 1",cat:"Oils",cal:190,p:0.5,c:8.0,f:17.5},
  {id:"o03",name:"Dressing 2",cat:"Oils",cal:89,p:0.4,c:9.0,f:5.8},
  {id:"o04",name:"Olive Oil",cat:"Oils",cal:884,p:0,c:0,f:100.0},
  {id:"o05",name:"Mustard",cat:"Oils",cal:149,p:8.0,c:9.0,f:9.0},
  {id:"v01",name:"Artichoke Hearts",cat:"Vegetables",cal:67,p:3.3,c:11.4,f:0.2},
  {id:"v02",name:"Avocado",cat:"Vegetables",cal:167,p:2.0,c:8.5,f:14.7},
  {id:"v03",name:"Beetroot",cat:"Vegetables",cal:43,p:1.6,c:9.6,f:0.2},
  {id:"v04",name:"Broccoli",cat:"Vegetables",cal:34,p:2.8,c:7.0,f:0.4},
  {id:"v05",name:"Brussel Sprouts",cat:"Vegetables",cal:41,p:3.4,c:7.1,f:0.5},
  {id:"v06",name:"Carrots",cat:"Vegetables",cal:41,p:0.9,c:9.6,f:0.2},
  {id:"v07",name:"Cauliflower",cat:"Vegetables",cal:25,p:1.9,c:5.0,f:0.3},
  {id:"v08",name:"Chickpeas Boiled",cat:"Vegetables",cal:163,p:8.9,c:27.4,f:2.6},
  {id:"v09",name:"Corn",cat:"Vegetables",cal:110,p:3.3,c:21.1,f:1.4},
  {id:"v10",name:"Cranberry Beans",cat:"Vegetables",cal:335,p:23.0,c:60.0,f:1.2},
  {id:"v11",name:"Cucumbers",cat:"Vegetables",cal:16,p:0.7,c:3.6,f:0.1},
  {id:"v12",name:"Garlic",cat:"Vegetables",cal:149,p:6.4,c:33.1,f:0.5},
  {id:"v13",name:"Green Beans",cat:"Vegetables",cal:35,p:1.8,c:7.1,f:0.3},
  {id:"v14",name:"Green Broad Beans",cat:"Vegetables",cal:88,p:7.9,c:11.7,f:0.7},
  {id:"v15",name:"Bell Pepper",cat:"Vegetables",cal:25,p:0.9,c:6.0,f:0.2},
  {id:"v16",name:"Lemon Juice",cat:"Vegetables",cal:29,p:0.4,c:9.3,f:0.2},
  {id:"v17",name:"Lettuce",cat:"Vegetables",cal:15,p:1.4,c:2.9,f:0.2},
  {id:"v18",name:"Mloukhia",cat:"Vegetables",cal:42,p:4.8,c:5.6,f:0.2},
  {id:"v19",name:"Mushrooms",cat:"Vegetables",cal:30,p:2.5,c:4.3,f:0.5},
  {id:"v20",name:"Okra",cat:"Vegetables",cal:43,p:1.9,c:7.5,f:0.9},
  {id:"v21",name:"Onions",cat:"Vegetables",cal:40,p:1.1,c:9.3,f:0.1},
  {id:"v22",name:"Potatoes",cat:"Vegetables",cal:87,p:2.0,c:20.1,f:0.1},
  {id:"v23",name:"Sweet Potatoes",cat:"Vegetables",cal:77,p:1.4,c:17.7,f:0.1},
  {id:"v24",name:"Radish",cat:"Vegetables",cal:16,p:0.7,c:3.4,f:0.1},
  {id:"v25",name:"Rokka",cat:"Vegetables",cal:35,p:2.6,c:3.7,f:0.7},
  {id:"v26",name:"Salad Mix",cat:"Vegetables",cal:22,p:1.5,c:3.5,f:0.3},
  {id:"v27",name:"Spinach",cat:"Vegetables",cal:34,p:2.9,c:3.6,f:0.4},
  {id:"v28",name:"Sweet Peas",cat:"Vegetables",cal:101,p:5.4,c:18.2,f:0.4},
  {id:"v29",name:"Tomatoes",cat:"Vegetables",cal:18,p:0.9,c:3.9,f:0.2},
  {id:"v30",name:"Zucchini",cat:"Vegetables",cal:17,p:1.2,c:3.1,f:0.3},
  {id:"l01",name:"Whiskey",cat:"Liquor",cal:250,p:0,c:0.1,f:0},
];

const MEALS = ["Breakfast","Lunch","Dinner","Snack"];
const CAT_ICONS = {Proteins:"ü•©","Dried Fruits":"üçá",Bread:"üçû",Fruits:"üçé",Nuts:"ü•ú",Oils:"ü´í",Vegetables:"ü•¨",Liquor:"ü•É"};
const CATEGORIES = [...new Set(FOOD_DB.map(f=>f.cat))];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE (localStorage)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function load(k, fallback) {
  try { const v = localStorage.getItem("fuel_"+k); return v ? JSON.parse(v) : fallback; }
  catch { return fallback; }
}
function save(k, v) { try { localStorage.setItem("fuel_"+k, JSON.stringify(v)); } catch {} }

let state = {
  entries: load("entries", []),
  water: load("water", {}),
  coffee: load("coffee", {}),
  goal: load("goal", 2000),
  proteinGoal: load("proteinGoal", 150),
  customFoods: load("customFoods", []),
  currentView: "log",
  selectedDate: todayStr(),
  selectedMeal: "Lunch",
  searchQ: "",
  filterCat: null,
  selectedFood: null,
  grams: "",
};

function todayStr() { return new Date().toISOString().slice(0,10); }
function fmtDate(d) { return new Date(d+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}); }
function allFoods() { return [...FOOD_DB, ...state.customFoods]; }
function persist() {
  save("entries", state.entries);
  save("water", state.water);
  save("coffee", state.coffee);
  save("goal", state.goal);
  save("proteinGoal", state.proteinGoal);
  save("customFoods", state.customFoods);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function dayEntries() { return state.entries.filter(e => e.date === state.selectedDate); }
function dayTotals() {
  return dayEntries().reduce((a,e) => ({cal:a.cal+e.cal, p:a.p+e.p, c:a.c+e.c, f:a.f+e.f, g:a.g+e.grams}), {cal:0,p:0,c:0,f:0,g:0});
}
function recentFoods() {
  const seen = new Set();
  const ids = [];
  for (let i = state.entries.length - 1; i >= 0 && ids.length < 6; i--) {
    if (!seen.has(state.entries[i].foodId)) { seen.add(state.entries[i].foodId); ids.push(state.entries[i].foodId); }
  }
  return ids.map(id => allFoods().find(f => f.id === id)).filter(Boolean);
}
function weekData() {
  const days = [];
  for (let i = 6; i >= 0; i--) {
    const d = new Date(); d.setDate(d.getDate()-i);
    const ds = d.toISOString().slice(0,10);
    const de = state.entries.filter(e => e.date === ds);
    const t = de.reduce((a,e) => ({cal:a.cal+e.cal,p:a.p+e.p,c:a.c+e.c,f:a.f+e.f}),{cal:0,p:0,c:0,f:0});
    days.push({date:ds, label:d.toLocaleDateString("en-US",{weekday:"short"}), ...t});
  }
  return days;
}
function searchFoods() {
  let results = allFoods();
  if (state.filterCat) results = results.filter(f => f.cat === state.filterCat);
  if (state.searchQ) { const q = state.searchQ.toLowerCase(); results = results.filter(f => f.name.toLowerCase().includes(q) || f.cat.toLowerCase().includes(q)); }
  return results.slice(0,20);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER ENGINE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function render() {
  const t = dayTotals();
  document.getElementById("headerCal").textContent = t.cal > 0 ? Math.round(t.cal) + " cal" : "";
  document.getElementById("fab").style.display = state.currentView === "log" ? "flex" : "none";
  renderNav();
  const c = document.getElementById("content");
  switch(state.currentView) {
    case "log": c.innerHTML = renderLog(); break;
    case "dash": c.innerHTML = renderDash(); break;
    case "foods": c.innerHTML = renderFoods(); break;
    case "settings": c.innerHTML = renderSettings(); break;
  }
  c.scrollTop = 0;
}

function renderNav() {
  const items = [{id:"log",icon:"üìã",label:"Log"},{id:"dash",icon:"üìä",label:"Dashboard"},{id:"foods",icon:"üóÇ",label:"Foods"},{id:"settings",icon:"‚öô",label:"Settings"}];
  document.getElementById("bottomNav").innerHTML = items.map(n =>
    `<button class="nav-btn ${state.currentView===n.id?'active':''}" onclick="switchView('${n.id}')">
      <span class="nav-icon">${n.icon}</span><span class="nav-label">${n.label}</span>
    </button>`
  ).join("");
}

// ‚îÄ‚îÄ LOG VIEW ‚îÄ‚îÄ
function renderLog() {
  const t = dayTotals();
  const calPct = Math.min(100, state.goal > 0 ? (t.cal/state.goal)*100 : 0);
  const remaining = Math.max(0, state.goal - Math.round(t.cal));
  const w = state.water[state.selectedDate] || 0;
  const cof = state.coffee[state.selectedDate] || 0;

  // SVG ring
  const sz=120, sw=7, r=(sz-sw)/2, circ=2*Math.PI*r, off=circ-(Math.min(calPct,100)/100)*circ;
  const ring = `<div class="ring-wrap">
    <svg width="${sz}" height="${sz}" style="transform:rotate(-90deg)">
      <circle cx="${sz/2}" cy="${sz/2}" r="${r}" fill="none" stroke="var(--border)" stroke-width="${sw}"/>
      <circle cx="${sz/2}" cy="${sz/2}" r="${r}" fill="none" stroke="var(--accent)" stroke-width="${sw}" stroke-dasharray="${circ}" stroke-dashoffset="${off}" stroke-linecap="round" style="transition:stroke-dashoffset 0.6s ease"/>
    </svg>
    <div class="ring-center"><div class="ring-val">${Math.round(t.cal)}</div><div class="ring-sub">of ${state.goal} cal</div></div>
  </div>`;

  const macros = [
    {name:"Protein",val:t.p,color:"var(--protein)",target:state.proteinGoal},
    {name:"Carbs",val:t.c,color:"var(--carbs)",target:null},
    {name:"Fat",val:t.f,color:"var(--fat)",target:null},
  ];
  const macroBars = macros.map(m => {
    const pct = m.target ? Math.min(100,(m.val/m.target)*100) : 100;
    return `<div class="macro-row">
      <label><span class="macro-name" style="color:${m.color}">${m.name}</span><span class="macro-val">${Math.round(m.val)}g${m.target?' / '+m.target+'g':''}</span></label>
      <div class="macro-bar"><div class="macro-bar-fill" style="width:${pct}%;background:${m.color}"></div></div>
    </div>`;
  }).join("");

  // Meal groups
  let mealHtml = "";
  MEALS.forEach(meal => {
    const items = dayEntries().filter(e => e.meal === meal);
    if (!items.length) return;
    const mealCal = items.reduce((a,e) => a+e.cal, 0);
    mealHtml += `<div class="meal-group">
      <div class="meal-header"><div class="meal-name">${meal}</div><div class="meal-cal">${mealCal} cal</div></div>
      ${items.map(e => `<div class="entry-row">
        <div class="entry-icon">${CAT_ICONS[e.cat]||"üçΩ"}</div>
        <div class="entry-info"><div class="entry-name">${e.name}</div><div class="entry-meta">${e.grams}g ¬∑ ${e.meal}</div></div>
        <div class="entry-cals"><div class="entry-cal-val">${e.cal}</div><div class="entry-macros"><span class="mp">P${e.p}</span> ¬∑ <span class="mc">C${e.c}</span> ¬∑ <span class="mf">F${e.f}</span></div></div>
        <button class="entry-del" onclick="deleteEntry('${e.id}')">‚úï</button>
      </div>`).join("")}
    </div>`;
  });

  if (!dayEntries().length) {
    mealHtml = `<div class="empty-state"><div class="empty-icon">üçΩ</div><div class="empty-title">No entries yet</div><div class="empty-sub">Tap + to log your first meal</div></div>`;
  }

  return `
    <div class="date-nav">
      <button onclick="changeDate(-1)">‚Äπ</button>
      <div class="date-text"><div class="date-main">${fmtDate(state.selectedDate)}</div>${state.selectedDate===todayStr()?'<div class="date-today">TODAY</div>':''}</div>
      <button onclick="changeDate(1)">‚Ä∫</button>
    </div>
    <div class="summary-grid">
      <div class="card ring-card">${ring}<div class="ring-remaining">${remaining} remaining</div></div>
      <div class="card macro-card">${macroBars}<div class="total-grams">Total: ${Math.round(t.g)}g food</div></div>
    </div>
    <div class="drinks-row">
      <div class="drink-card">
        <span class="drink-icon">üíß</span>
        <div class="drink-info"><div class="drink-label">Water</div><div class="drink-count">${w} glasses</div></div>
        <button class="drink-btn minus" onclick="adjustDrink('water',-1)">‚àí</button>
        <button class="drink-btn plus" onclick="adjustDrink('water',1)">+</button>
      </div>
      <div class="drink-card">
        <span class="drink-icon">‚òï</span>
        <div class="drink-info"><div class="drink-label">Coffee</div><div class="drink-count">${cof} cups</div></div>
        <button class="drink-btn minus" onclick="adjustDrink('coffee',-1)">‚àí</button>
        <button class="drink-btn plus" onclick="adjustDrink('coffee',1)">+</button>
      </div>
    </div>
    ${mealHtml}
  `;
}

// ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ
function renderDash() {
  const wd = weekData();
  const maxCal = Math.max(...wd.map(d=>d.cal), 1);
  const avgCal = Math.round(wd.reduce((a,d)=>a+d.cal,0)/7);
  const avgP = Math.round(wd.reduce((a,d)=>a+d.p,0)/7);
  const maxP = Math.max(...wd.map(d=>d.p), 1);
  const t = dayTotals();

  const bars = wd.map(d => {
    const h = Math.max(2, (d.cal/maxCal)*110);
    const isToday = d.date === state.selectedDate;
    return `<div class="bar-col ${isToday?'today':''}">
      <div class="bar-val">${d.cal||""}</div>
      <div class="bar-fill" style="height:${h}px"></div>
      <div class="bar-label">${d.label}</div>
    </div>`;
  }).join("");

  const protBars = wd.map(d => {
    const h = Math.max(2, (d.p/maxP)*70);
    return `<div class="ac-col">
      <div class="ac-bar" style="height:${h}px"></div>
      <div class="ac-dot"></div>
      <div class="ac-label">${d.label}</div>
    </div>`;
  }).join("");

  // Macro pie via conic-gradient
  const pCal = Math.round(t.p*4), cCal = Math.round(t.c*4), fCal = Math.round(t.f*9);
  const total = pCal+cCal+fCal || 1;
  const pPct = (pCal/total*100), cPct = (cCal/total*100), fPct = (fCal/total*100);
  const pieGrad = `conic-gradient(var(--protein) 0% ${pPct}%, var(--carbs) ${pPct}% ${pPct+cPct}%, var(--fat) ${pPct+cPct}% 100%)`;

  // Category breakdown
  const catData = {};
  dayEntries().forEach(e => { catData[e.cat] = (catData[e.cat]||0) + e.cal; });
  const catArr = Object.entries(catData).sort((a,b)=>b[1]-a[1]);
  const catMax = catArr[0]?.[1] || 1;
  const catHtml = catArr.length ? catArr.map(([name,val]) =>
    `<div class="cat-break-row"><div class="cat-break-head"><span class="cat-break-name">${CAT_ICONS[name]||""} ${name}</span><span class="cat-break-val">${val}</span></div><div class="cat-break-bar"><div class="cat-break-fill" style="width:${(val/catMax)*100}%"></div></div></div>`
  ).join("") : '<div style="color:var(--text2);font-size:12px;padding:20px;text-align:center">No data yet</div>';

  // Weekly stats
  const calsOnly = wd.filter(d=>d.cal>0).map(d=>d.cal);
  const bestDay = calsOnly.length ? Math.max(...calsOnly) : "‚Äî";
  const lowDay = calsOnly.length ? Math.min(...calsOnly) : "‚Äî";
  const totalWeek = wd.reduce((a,d)=>a+d.cal,0);

  return `
    <div class="dash-title">Dashboard</div>
    <div class="dash-sub">7-day overview</div>
    <div class="card chart-card">
      <div class="chart-label">WEEKLY CALORIES</div>
      <div class="chart-value">Avg ${avgCal} cal/day</div>
      <div class="bar-chart">${bars}</div>
    </div>
    <div class="card chart-card">
      <div class="chart-label">PROTEIN TREND</div>
      <div class="chart-value">Avg ${avgP}g/day</div>
      <div class="area-chart">${protBars}</div>
    </div>
    <div class="two-col">
      <div class="card pie-card">
        <div class="chart-label" style="margin-bottom:12px">MACRO SPLIT</div>
        ${t.cal > 0 ? `
          <div class="pie-wrap" style="background:${pieGrad}"><div class="pie-center"><div class="pie-center-val">${Math.round(t.cal)}</div><div class="pie-center-label">cal</div></div></div>
          <div class="pie-legend">
            <div class="pie-leg-item"><div class="pie-leg-name" style="color:var(--protein)">Protein</div><div class="pie-leg-pct">${Math.round(pPct)}%</div></div>
            <div class="pie-leg-item"><div class="pie-leg-name" style="color:var(--carbs)">Carbs</div><div class="pie-leg-pct">${Math.round(cPct)}%</div></div>
            <div class="pie-leg-item"><div class="pie-leg-name" style="color:var(--fat)">Fat</div><div class="pie-leg-pct">${Math.round(fPct)}%</div></div>
          </div>
        ` : '<div style="color:var(--text2);font-size:12px;padding:30px">No data</div>'}
      </div>
      <div class="card">
        <div class="chart-label" style="margin-bottom:12px">BY CATEGORY</div>
        <div class="cat-break">${catHtml}</div>
      </div>
    </div>
    <div class="card">
      <div class="chart-label" style="margin-bottom:12px">WEEKLY SUMMARY</div>
      <div class="stat-grid">
        <div class="stat-item"><div class="stat-val">${totalWeek.toLocaleString()}</div><div class="stat-label">Total Cal</div></div>
        <div class="stat-item"><div class="stat-val">${typeof bestDay==='number'?bestDay+' cal':bestDay}</div><div class="stat-label">Best Day</div></div>
        <div class="stat-item"><div class="stat-val">${typeof lowDay==='number'?lowDay+' cal':lowDay}</div><div class="stat-label">Low Day</div></div>
      </div>
    </div>
  `;
}

// ‚îÄ‚îÄ FOODS VIEW ‚îÄ‚îÄ
function renderFoods() {
  const foods = searchFoods();
  const catPills = CATEGORIES.map(c =>
    `<button class="cat-pill ${state.filterCat===c?'active':''}" onclick="toggleFilterCat('${c}')">${CAT_ICONS[c]} ${c}</button>`
  ).join("");

  const foodList = foods.map(f =>
    `<div class="food-item">
      <span class="fi-icon">${CAT_ICONS[f.cat]||"üçΩ"}</span>
      <div class="fi-info"><div class="fi-name">${f.name}</div><div class="fi-cat">${f.cat}</div></div>
      <div class="fi-cal-col"><div class="fi-cal">${f.cal}</div><div class="fi-calunit">cal/100g</div></div>
      <div class="fi-macros"><span style="color:var(--protein)">P${f.p}</span> <span style="color:var(--carbs)">C${f.c}</span> <span style="color:var(--fat)">F${f.f}</span></div>
    </div>`
  ).join("");

  return `
    <div class="foods-head">
      <div><div class="foods-title">Food Database</div><div class="foods-count">${allFoods().length} items</div></div>
      <button class="add-food-btn" onclick="openCustomFood()">+ Add Food</button>
    </div>
    <div class="cat-pills">
      <button class="cat-pill ${!state.filterCat?'active':''}" onclick="toggleFilterCat(null)">All</button>
      ${catPills}
    </div>
    <input class="search-input" placeholder="Search foods..." value="${state.searchQ}" oninput="state.searchQ=this.value;render()">
    ${foodList}
  `;
}

// ‚îÄ‚îÄ SETTINGS VIEW ‚îÄ‚îÄ
function renderSettings() {
  return `
    <div class="settings-title">Settings</div>
    <div class="card settings-section">
      <div class="settings-label">DAILY GOALS</div>
      <div class="settings-field"><label>Calorie Goal</label><input class="settings-input" type="number" value="${state.goal}" onchange="state.goal=parseInt(this.value)||0;persist();render()"></div>
      <div class="settings-field"><label>Protein Goal (g)</label><input class="settings-input" type="number" value="${state.proteinGoal}" onchange="state.proteinGoal=parseInt(this.value)||0;persist();render()"></div>
    </div>
    <div class="card settings-section">
      <div class="settings-label">DATA</div>
      <button class="btn-danger" onclick="if(confirm('Clear ALL data? This cannot be undone.')){state.entries=[];state.water={};state.coffee={};state.customFoods=[];persist();render();}">Reset All Data</button>
    </div>
    <div class="card settings-section">
      <div class="settings-label">ABOUT</div>
      <div class="about-text"><strong>FUEL</strong> ‚Äî Calorie &amp; Macro Tracker<br>Your personal food database with ${allFoods().length} items.<br>Data persists in your browser via localStorage.</div>
    </div>
  `;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ADD FOOD MODAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openAddModal() {
  state.searchQ = ""; state.filterCat = null; state.selectedFood = null; state.grams = "";
  renderModal();
  document.getElementById("modalOverlay").style.display = "flex";
  setTimeout(() => { const inp = document.getElementById("modalSearch"); if(inp) inp.focus(); }, 150);
}

function closeModal() {
  document.getElementById("modalOverlay").style.display = "none";
  render();
}

function renderModal() {
  const ms = document.getElementById("modalSheet");
  if (!state.selectedFood) {
    // Search view
    const mealTabs = MEALS.map(m =>
      `<button class="meal-tab ${state.selectedMeal===m?'active':''}" onclick="state.selectedMeal='${m}';renderModal()">${m}</button>`
    ).join("");

    const catPills = CATEGORIES.map(c =>
      `<button class="cat-pill ${state.filterCat===c?'active':''}" onclick="state.filterCat=state.filterCat==='${c}'?null:'${c}';renderModal()">${CAT_ICONS[c]}</button>`
    ).join("");

    const recent = recentFoods();
    const recentHtml = (!state.searchQ && !state.filterCat && recent.length) ?
      `<div class="recent-section"><div class="recent-label">RECENT</div><div class="recent-chips">${recent.map(f =>
        `<button class="recent-chip" onclick="selectFood('${f.id}')">${CAT_ICONS[f.cat]} ${f.name}</button>`
      ).join("")}</div></div>` : "";

    const results = searchFoods();
    const resultHtml = results.map(f =>
      `<button class="food-result" onclick="selectFood('${f.id}')">
        <span class="fr-icon">${CAT_ICONS[f.cat]||"üçΩ"}</span>
        <div class="fr-info"><div class="fr-name">${f.name}</div><div class="fr-macros">P${f.p} ¬∑ C${f.c} ¬∑ F${f.f}</div></div>
        <span class="fr-cal">${f.cal}</span><span class="fr-unit">cal/100g</span>
      </button>`
    ).join("");

    ms.innerHTML = `
      <div class="modal-head"><div class="modal-title">Add Food</div><button class="modal-close" onclick="closeModal()">‚úï</button></div>
      <div class="meal-tabs">${mealTabs}</div>
      <input id="modalSearch" class="search-input" placeholder="Search foods... (e.g. chicken, apple)" value="${state.searchQ}" oninput="state.searchQ=this.value;renderModal()">
      <div class="cat-pills">${catPills}</div>
      ${recentHtml}
      <div class="food-results">${resultHtml}</div>
    `;
  } else {
    // Gram entry view
    const f = state.selectedFood;
    const g = parseFloat(state.grams) || 0;
    const hasGrams = g > 0;
    const cal = Math.round(f.cal * g / 100);
    const pv = (f.p * g / 100).toFixed(1);
    const cv = (f.c * g / 100).toFixed(1);
    const fv = (f.f * g / 100).toFixed(1);

    const quickWeights = [25,50,100,150,200,300,500].map(w =>
      `<button class="qw-btn ${state.grams==w?'active':''}" onclick="state.grams='${w}';renderModal();document.getElementById('gramInput').value='${w}'">${w}g</button>`
    ).join("");

    const preview = hasGrams ? `
      <div class="live-preview">
        <div class="lp-top"><span class="lp-label">Calories</span><span class="lp-cal">${cal}</span></div>
        <div class="lp-macros">
          <div class="lp-macro"><div class="lp-macro-val" style="color:var(--protein)">${pv}g</div><div class="lp-macro-label">Protein</div></div>
          <div class="lp-macro"><div class="lp-macro-val" style="color:var(--carbs)">${cv}g</div><div class="lp-macro-label">Carbs</div></div>
          <div class="lp-macro"><div class="lp-macro-val" style="color:var(--fat)">${fv}g</div><div class="lp-macro-label">Fat</div></div>
        </div>
      </div>` : "";

    ms.innerHTML = `
      <div class="modal-head"><div class="modal-title">Add ${f.name}</div><button class="modal-close" onclick="closeModal()">‚úï</button></div>
      <div class="gram-header">
        <div class="gh-icon">${CAT_ICONS[f.cat]||"üçΩ"}</div>
        <div class="gh-cal">${f.cal} cal/100g</div>
        <div class="gh-macros"><span style="color:var(--protein)">P${f.p}</span> ¬∑ <span style="color:var(--carbs)">C${f.c}</span> ¬∑ <span style="color:var(--fat)">F${f.f}</span> per 100g</div>
      </div>
      <div class="gram-input-wrap">
        <input id="gramInput" class="gram-input" type="number" placeholder="0" value="${state.grams}" oninput="state.grams=this.value;renderModal()" onkeydown="if(event.key==='Enter')addEntry()">
        <span class="gram-unit">grams</span>
      </div>
      <div class="quick-weights">${quickWeights}</div>
      ${preview}
      <div class="action-row">
        <button class="btn-secondary" onclick="state.selectedFood=null;state.grams='';renderModal()">Back</button>
        <button class="btn-primary" ${!hasGrams?'disabled':''} onclick="addEntry()">Log ${state.selectedMeal}</button>
      </div>
    `;
    setTimeout(() => { const inp = document.getElementById("gramInput"); if(inp && !state.grams) inp.focus(); }, 100);
  }
}

function selectFood(id) {
  state.selectedFood = allFoods().find(f => f.id === id);
  state.grams = "";
  renderModal();
}

function addEntry() {
  const f = state.selectedFood;
  const g = parseFloat(state.grams);
  if (!f || !g || g <= 0) return;
  const mult = g / 100;
  state.entries.push({
    id: Date.now().toString(36) + Math.random().toString(36).slice(2,6),
    foodId: f.id, name: f.name, cat: f.cat, grams: g,
    cal: Math.round(f.cal * mult),
    p: Math.round(f.p * mult * 10) / 10,
    c: Math.round(f.c * mult * 10) / 10,
    f: Math.round(f.f * mult * 10) / 10,
    meal: state.selectedMeal,
    date: state.selectedDate,
    time: new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),
  });
  persist();
  closeModal();
}

function deleteEntry(id) {
  state.entries = state.entries.filter(e => e.id !== id);
  persist(); render();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CUSTOM FOOD MODAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openCustomFood() {
  const catOpts = CATEGORIES.map(c => `<option value="${c}">${c}</option>`).join("");
  document.getElementById("customBox").innerHTML = `
    <div class="modal-head"><div class="modal-title">Add Custom Food</div><button class="modal-close" onclick="closeCustom()">‚úï</button></div>
    <div class="custom-sub">All values per 100g</div>
    <div class="custom-field"><label>Food Name</label><input id="cf_name" placeholder="e.g. Greek Moussaka"></div>
    <div class="custom-field"><label>Category</label><select id="cf_cat">${catOpts}</select></div>
    <div class="custom-field"><label>Calories / 100g</label><input id="cf_cal" type="number" placeholder="0"></div>
    <div class="custom-field"><label>Protein (g)</label><input id="cf_p" type="number" placeholder="0"></div>
    <div class="custom-field"><label>Carbs (g)</label><input id="cf_c" type="number" placeholder="0"></div>
    <div class="custom-field"><label>Fat (g)</label><input id="cf_f" type="number" placeholder="0"></div>
    <div class="action-row">
      <button class="btn-secondary" onclick="closeCustom()">Cancel</button>
      <button class="btn-primary" onclick="saveCustomFood()">Add Food</button>
    </div>
  `;
  document.getElementById("customOverlay").style.display = "flex";
}

function closeCustom() { document.getElementById("customOverlay").style.display = "none"; }

function saveCustomFood() {
  const name = document.getElementById("cf_name").value.trim();
  const cal = parseFloat(document.getElementById("cf_cal").value) || 0;
  if (!name || !cal) return;
  state.customFoods.push({
    id: "custom_" + Date.now().toString(36),
    name,
    cat: document.getElementById("cf_cat").value,
    cal,
    p: parseFloat(document.getElementById("cf_p").value) || 0,
    c: parseFloat(document.getElementById("cf_c").value) || 0,
    f: parseFloat(document.getElementById("cf_f").value) || 0,
  });
  persist();
  closeCustom();
  render();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ACTIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function switchView(v) { state.currentView = v; state.searchQ = ""; state.filterCat = null; render(); }
function changeDate(delta) {
  const d = new Date(state.selectedDate + "T12:00:00");
  d.setDate(d.getDate() + delta);
  state.selectedDate = d.toISOString().slice(0,10);
  render();
}
function adjustDrink(type, delta) {
  const key = type === "water" ? "water" : "coffee";
  const obj = state[key];
  obj[state.selectedDate] = Math.max(0, (obj[state.selectedDate] || 0) + delta);
  persist(); render();
}
function toggleFilterCat(cat) { state.filterCat = state.filterCat === cat ? null : cat; render(); }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
render();
</script>
</body>
</html>
